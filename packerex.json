{
	"variables": {
		"aws_access_key": "",
		"aws_secret_key": ""
	},
	"builders": [{
		"type": "amazon-ebs",
		"access_key": "{{user `aws_access_key`}}",
		"secret_key": "{{user `aws_secret_key`}}",
		"region": "us-west-1",
		"source_ami_filter": {
			"filters": {
				"virtualization-type": "hvm",
				"name": "*ubuntu*",
				"root-device-type": "ebs"

			},
			"owners": ["099720109477", "self","679593333241"],
			"most_recent": true
		},
		"instance_type": "t2.micro",
		"ssh_username": "ubuntu",
		"ami_name": "demo_rahul_{{timestamp}}"
	},

	{
		 "type": "googlecompute",
		 "ssh_username": "ubuntu",
		 "account_file": "account.json",
	         "project_id": "striking-scout-194418",
		 "source_image": "ubuntu-1710-artful-v20180126",
	         "zone": "us-central1-a"
	},

	{
                 "type": "digitalocean",
		 "api_token": "9549702da990894286493720d673179f4e1daaebce85d54f473fa741fec635dc",
		 "image": "ubuntu-16-04-x64",
		 "region": "nyc3",
		 "size": "512mb",
	         "ssh_username": "root"
	}
	
	],
	"provisioners": [{
			"type": "shell",
			"inline": [
				"sleep 30",
				"sudo apt-get update",
				"sudo apt-get install software-properties-common",
				"sudo apt-get install -y python redis-server ansible",
				"dpkg-query -l > package.list"
			]
		},
		{
			"type": "ansible",
			"playbook_file": "apache/apache.yml",
			"extra_arguments": ["--extra-vars","ansible_sudo_pass=rahul"]
		},
		{      "type": "file",
		       "source": "package.list",
		       "destination": "package.list",
		       "direction": "download"
		}

	]
}
